第七章

![image](images/frontdot.jpg)

数组

数组是一种数据结构，用于存储所有具有相同数据类型的值的集合。

数组声明和分配

要声明一个数组，可以像普通的变量声明一样开始，但是在数组名后面附加一组方括号。括号包含数组中元素的数量。这些元素的默认值与变量相同——全局数组中的元素被初始化为默认值，而局部数组中的元素保持未初始化状态。

```cpp
int myArray[3]; // integer array with 3 elements
```

数组赋值

要为元素赋值，可以通过将元素的索引放在方括号内(从零开始)来一次引用一个元素。

```cpp
myArray[0] = 1;
myArray[1] = 2;
myArray[2] = 3;
```

或者，您可以在声明数组的同时赋值，方法是用花括号将它们括起来。指定的数组长度可以选择省略，让数组大小由赋值的数量决定。

```cpp
int myArray[3] = { 1, 2, 3 };
int myArray[] = { 1, 2, 3 };
```

一旦数组元素被初始化，就可以通过引用所需元素的索引来访问它们。

```cpp
std::cout << myArray[0]; // 1
```

多维数组

通过添加多组方括号，可以使数组成为多维数组。与一维数组一样，它们可以一次填充一个，也可以在声明过程中一次全部填充。

```cpp
int myArray[2][2] = { { 0, 1 }, { 2, 3 } };
myArray[0][0] = 0;
myArray[0][1] = 1;
```

额外的花括号是可选的，但是包含它们是一个很好的实践，因为它使代码更容易理解。

```cpp
int mArray[2][2] = { 0, 1, 2, 3 }; // alternative
```

动态数组

因为上面的数组是由静态(非动态)内存组成的，所以在执行之前必须确定它们的大小。因此，大小需要是一个常量值。为了创建一个直到运行时才知道大小的数组，你需要使用动态内存，它是用关键字`new`分配的，必须分配给一个指针或引用。

```cpp
int* p = new int[3]; // dynamically allocated array
```

C++中的数组表现为指向数组中第一个元素的常量指针。因此，数组元素的引用也可以用指针算法来实现。通过将指针递增 1，可以移动到数组中的下一个元素，因为对指针地址的更改会隐式地乘以指针数据类型的大小。

```cpp
*(p+1) = 10; // p[1] = 10;
```

数组大小

就像任何其他指针一样，有可能超出数组的有效范围，从而重写一些相邻的内存。这是应该避免的，因为它会导致意想不到的结果或程序崩溃。

```cpp
int myArray[2] = { 1, 2 };
myArray[2] = 3; // out of bounds error
```

要确定一个常规(静态分配)数组的长度，可以使用`sizeof`操作符。

```cpp
int length = sizeof(myArray) / sizeof(int); // 2
```

此方法不能用于动态分配的数组。确定这种数组大小的唯一方法是通过在数组分配中使用的变量。

```cpp
int size = 3;
int* p = new int[size]; // dynamically allocated array
```

当你使用完一个动态数组时，你必须记得删除它。这是通过使用带有一组方括号的关键字`delete`来完成的。

```cpp
delete[] p; // release allocated array
```