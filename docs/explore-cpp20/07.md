# 7.更多循环

探索 [2](02.html) 和 [3](03.html) 展示了一些简单的`while`循环。这个探索引入了`while`循环的老大哥，`for`循环。

## 有界循环

您已经看到了`while`循环，它从标准输入读取数据，直到没有更多输入可用。这是一个典型的*无界*循环。除非您事先确切知道输入流将包含什么，否则您无法确定循环的界限或限制。有时你预先知道循环必须运行多少次；也就是说，你知道循环的边界，使它成为一个*有界的*循环。`for`循环是 C++实现有界循环的方式。

让我们从一个简单的例子开始。清单 [7-1](#PC1) 显示了一个打印前十个非负整数的程序。

```cpp
import <iostream>;

int main()
{
  for (int i{0}; i != 10; i = i + 1)
    std::cout << i << '\n';
}

Listing 7-1.Using a for Loop to Print Ten Non-negative Numbers

```

`for`循环在一个小空间里塞满了大量信息，所以一步一步来。括号内是循环的三个部分，用分号分隔。**你觉得这三件是什么意思？**

*   _____________________________________________________________

*   _____________________________________________________________

*   _____________________________________________________________

*   _____________________________________________________________

这三个部分是初始化、条件和后迭代。仔细看看每个部分。

### 初始化

第一部分看起来类似于变量定义。它定义了一个名为`i`的`int`变量，初始值为 0。一些受 C 启发的语言只允许初始化表达式，而不允许变量定义。在 C++中，你有一个选择:表达式或定义。将循环控制变量定义为初始化的一部分的好处是，您不会意外地在循环之外引用该变量。在初始化部分定义循环控制变量的缺点是，您不能故意在循环之外引用该变量。清单 [7-2](#PC2) 展示了限制回路控制变量的优势。

```cpp
import <iostream>;

int main()
{
  for (int i{0}; i != 10; i = i + 1)
    std::cout << i << '\n';
  std::cout << "i=" << i << '\n';        // error: i is undefined outside the loop
}

Listing 7-2.You Cannot Use the Loop Control Variable Outside the Loop

```

限制循环控制变量的另一个后果是，您可能在多个循环中定义和使用相同的变量名，如清单 [7-3](#PC3) 所示。

```cpp
import <iostream>;

int main()
{
  std::cout << '+';
  for (int i{0}; i != 20; i = i + 1)
    std::cout << '-';
  std::cout << "+\n|";

  for (int i{0}; i != 3; i = i + 1)
    std::cout << ' ';
  std::cout << "Hello, reader!";

  for (int i{0}; i != 3; i = i + 1)
    std::cout << ' ';
  std::cout << "|\n+";

  for (int i{0}; i != 20; i = i + 1)
    std::cout << '-';
  std::cout << "+\n";
}

Listing 7-3.Using and Reusing a Loop Control Variable Name

```

**清单** [**7-3**](#PC3) **产生什么作为输出？**

*   _____________________________________________________________

*   _____________________________________________________________

*   _____________________________________________________________

如果不必执行任何初始化，可以将初始化部分留空，但仍然需要分号来分隔空初始化和条件。

### 情况

中间部分遵循与`while`循环条件相同的规则。正如您所料，它控制着循环的执行。当条件为真时，循环体执行。如果条件为假，循环终止。如果循环第一次运行时条件为假，则循环体永远不会执行(但初始化部分总是执行)。

有时您会看到一个`for`循环，其中缺少一个条件。这意味着条件总是为真，所以循环会不停地运行。编写始终为真的条件的更好方法是显式地使用`true`作为条件。这样，任何将来必须阅读和维护您的代码的人都会明白，您故意将循环设计为永远运行。可以把它想象成一个注释:“这个条件故意留空白。”

### 后迭代

最后一部分看起来像一个语句，尽管它缺少结尾的分号。其实并不是完整的陈述，只是一种表达。表达式在循环体之后(因此命名为 *post* 迭代)和再次测试条件之前被求值。你可以把任何你想要的东西放在这里，或者留空。通常，`for`循环的这一部分控制迭代，根据需要推进循环控制变量。

### 一个`for`循环如何工作

控制流程如下:

1.  初始化部分只运行一次。

2.  测试条件。如果为 false，则循环终止，程序继续执行循环体后面的语句。

3.  如果条件为真，则执行循环体。

4.  后迭代部分执行。

5.  控制跳转到 2。

## 轮到你了

现在轮到你写一个`for`循环了。清单 7-4 展示了一个 C++程序的框架。**填写缺失的部分，计算整数之和** **从 10 到 20，包括 10 和 20。**

```cpp
import <iostream>;

int main()
{
  int sum{0};

  // Write the loop here.

  std::cout << "Sum of 10 to 20 = " << sum << '\n';
}

Listing 7-4.Compute Sum of Integers from 10 to 20

```

在测试你的程序之前，你必须首先确定你如何知道程序是否正确。换句话说，**10 到 20 的整数之和是多少，含 10 和 20？**_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

好，现在编译并运行你的程序。你的程序产生了什么答案？_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _**你的程序正确吗？**_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

将您的程序与清单 [7-5](#PC5) 中所示的程序进行比较。

```cpp
import <iostream>;

int main()
{
  int sum{0};
  for (int i{10}; i != 21; i = i + 1)
    sum = sum + i;
  std::cout << "Sum of 10 to 20 = " << sum << '\n';
}

Listing 7-5.Compute Sum of Integers from 10 to 20 (Completed)

```

`for`循环的用途是格式化和打印信息表。要实现这一点，您需要比目前所学的更好地控制输出格式。这将是下一次探索的主题。